{% extends 'OkaFileBundle::layout.html.twig' %}

{% block title %}{{ parent() }}{% endblock %}

{% block stylesheets %}{{ parent() }}{% endblock %}

{% block body %}
	<div class="row">
		<div class="twelve columns">
			<h3>Fiche d'image</h3>
			<hr>
		</div>
		
        <div class="twelve columns">
        	<div class="row">
        		<div class="six columns">
        			<a href="#" class="th show-picture-original" data-picture-original="{{ entity.getUri() }}">
        				<img src="{{ entity.getUriFor('250', '250') }}">
        			</a>
        		</div>
        		<div class="six columns">
        			<img id="dominant-color" src="{{ entity.getPlaceholder() }}" width="250" height="250">
        		</div>
        		
        		<div class="twelve columns">
        			<div class="row">
        				<div class="twelve columns">
        					<ul class="block-grid two-up">
        						<li><a href="{{ path('oka_file_image_update', {'id': entity.id}) }}" class="button succes">Modifier</a></li>
        						<li><a href="{{ path('oka_file_image_delete', {'id': entity.id}) }}" class="button alert remove-action">Supprimer</a></li>
        					</ul>
        				</div>
        				{% if app.session.flashbag.get('picture-remove-warning') %}
        					<div class="twelve columns">
        						{% for flashMessage in app.session.flashbag.get('picture-remove-warning') %}
        							<div class="alert-box alert">
        								{{ flashMessage }}
        								<a href="" class="close">&times;</a>
        							</div>
        						{% endfor %}
        					</div>
        				{% endif %}
        				<div class="twelve columns">
        					<a href="{{ path('oka_file_image_list') }}">Retour à la liste</a>
        				</div>
        			</div>
        		</div>
        	</div>
        	<hr>
        </div>
        
{#         <div class="twelve columns">#}
{#         	<h6>Cropper l'images pour les tailles suivantes :</h6>#}
{#         	<ul class="inline-list">#}
{#         		{% for key, crop in crop_size %}#}
{#         			<li><a href="{{ path('oka_file_image_crop', {'id': entity.id, 'width': crop.width, 'height': crop.height}) }}"><span class="has-tip" data-width="210" title="{{ crop.description }}">{{ key }}</span></a></li>#}
{#         		{% endfor %}#}
{#         	</ul>#}
{#         	<hr>#}
{#         </div>#}
        
{#         <div class="twelve columns">#}
{#         	<ul class="block-grid one-up">#}
{#         		{% for thumbnail in entity.getWebPathOfAllSize('normal') %}#}
{#         			<li>#}
{#         				{% set items = thumbnail | split('/')  %}#}
{#         				{% set length = items | length %}#}
{#         				{% set size = items[length - 2] | trim | split('x') %}#}
        				
{#         				<u>Taille</u> : {{ items[length - 2] }} &raquo; {% if crop_size[items[length - 2]] is defined %}{{ crop_size[items[length - 2]].description }}{% else %}Non défini{% endif %}#}
{#         				<br>#}
{#         				<img src="{{ thumbnail }}"/>#}
{#         				<br>#}
{#         				<ul class="inline-list">#}
{#         					<li><a href="{{ path('oka_file_image_crop', {'id': entity.id, 'width': size[0], 'height': size[1]}) }}">Recadrer</a></li>#}
{#         					<li><a href="{{ path('oka_file_image_default_crop', {'id': entity.id, 'width': size[0], 'height': size[1]}) }}">Appliquer le recadrage par defaut</a></li>#}
{#         					<li><a href="{{ path('oka_file_image_delete_size', {'id': entity.id, 'size': items[length - 2]  | trim}) }}">Supprimer</a></li>#}
{#         				</ul>#}
{#         			</li>#}
{#         		{% endfor %}#}
{#         	</ul>#}
{#         </div>#}
	</div>
{% endblock %}

{% block footer %}{{ parent() }}{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script type="text/javascript">
		$(document).ready(function(){
// 			var header = new Buffer('474946383961', 'hex');
// 			var logicalScreenDescriptor = new Buffer('01000100800100', 'hex');
// 			var imageDescriptor = new Buffer('2c000000000100010000', 'hex');
// 			var imageData = new Buffer('0202440100', 'hex');

// 			var gif = [
// 	            header,
// 	            logicalScreenDescriptor,
//	            {{ entity.dominantColor }},
// 	            new Buffer([0, 0, 0]),
// 	            imageDescriptor,
// 	            imageData
// 	        ];

// 	        $img = $('#dominant-color');
// 	        $img.attr('src', 'data:image/gif;base64,' + Buffer.concat(gif).toString('base64'));
		});
	</script>
{% endblock %}
